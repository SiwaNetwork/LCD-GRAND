#!/usr/bin/env python3
"""
–ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç –¥–∏—Å–ø–ª–µ—è –¥–ª—è Raspberry Pi CM4 —Å LCD
–ó–∞–ø—É—Å–∫–∞–µ—Ç –±–∞–∑–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞ —ç–∫—Ä–∞–Ω–µ
"""

import time
from lcd_game import LCDGame
from config import COLORS

def simple_display_test():
    """–ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è"""
    try:
        print("–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è LCD –¥–∏—Å–ø–ª–µ—è...")

        # –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –¥–∏—Å–ø–ª–µ—è
        lcd = LCDGame()
        print("‚úì LCD –¥–∏—Å–ø–ª–µ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")

        # –û—á–∏—Å—Ç–∫–∞ —ç–∫—Ä–∞–Ω–∞
        print("–û—á–∏—Å—Ç–∫–∞ —ç–∫—Ä–∞–Ω–∞...")
        lcd.clear(COLORS['BLACK'])
        print("‚úì –≠–∫—Ä–∞–Ω –æ—á–∏—â–µ–Ω")

        # –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
        print("–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞...")
        lcd.draw_text("CM4 LCD Test", 40, 50, COLORS['WHITE'], 16)
        lcd.draw_text("SHIWA NETWORK", 30, 80, COLORS['GREEN'], 14)
        lcd.draw_text("Grand Mini", 50, 110, COLORS['BLUE'], 14)
        print("‚úì –¢–µ–∫—Å—Ç –æ—Ç–æ–±—Ä–∞–∂–µ–Ω")

        # –†–∏—Å–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç–æ–π –≥–µ–æ–º–µ—Ç—Ä–∏–∏
        print("–†–∏—Å–æ–≤–∞–Ω–∏–µ —Ñ–∏–≥—É—Ä...")
        lcd.draw_rect(50, 140, 100, 40, COLORS['RED'], fill=True)
        lcd.draw_circle(120, 200, 25, COLORS['YELLOW'], fill=True)
        print("‚úì –§–∏–≥—É—Ä—ã –Ω–∞—Ä–∏—Å–æ–≤–∞–Ω—ã")

        # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∏—Å–ø–ª–µ—è
        print("–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∏—Å–ø–ª–µ—è...")
        lcd.update()
        print("‚úì –î–∏—Å–ø–ª–µ–π –æ–±–Ω–æ–≤–ª–µ–Ω")

        print("\nüéâ –¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ!")
        print("–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –Ω–∞ LCD —ç–∫—Ä–∞–Ω–µ")
        print("–ù–∞–∂–º–∏—Ç–µ Ctrl+C –¥–ª—è –≤—ã—Ö–æ–¥–∞")

        # –ñ–¥–µ–º 5 —Å–µ–∫—É–Ω–¥, –∑–∞—Ç–µ–º –º–∏–≥–∞–µ–º –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π
        time.sleep(5)

        print("–¢–µ—Å—Ç –ø–æ–¥—Å–≤–µ—Ç–∫–∏...")
        for i in range(3):
            lcd.set_backlight(False)
            time.sleep(0.5)
            lcd.set_backlight(True)
            time.sleep(0.5)

        print("–¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω. –î–∏—Å–ø–ª–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!")

    except KeyboardInterrupt:
        print("\n–¢–µ—Å—Ç –ø—Ä–µ—Ä–≤–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º")
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
        print("–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:")
        print("1. –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥–∏—Å–ø–ª–µ—è")
        print("2. –í–∫–ª—é—á–µ–Ω –ª–∏ SPI –≤ raspi-config")
        print("3. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: pip3 install -r requirements.txt")
    finally:
        try:
            if 'lcd' in locals():
                print("–û—á–∏—Å—Ç–∫–∞ —Ä–µ—Å—É—Ä—Å–æ–≤...")
                lcd.cleanup()
                print("‚úì –†–µ—Å—É—Ä—Å—ã –æ—á–∏—â–µ–Ω—ã")
        except:
            pass

if __name__ == "__main__":
    print("=" * 50)
    print("–ü–†–û–°–¢–û–ô –¢–ï–°–¢ LCD –î–ò–°–ü–õ–ï–Ø")
    print("–î–ª—è Raspberry Pi CM4")
    print("=" * 50)
    simple_display_test()
